name: Test PSO Algorithm

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up R
      uses: r-lib/actions/setup-r@v2
      with:
        r-version: '4.3.0'
    
    - name: Install R dependencies
      run: |
        Rscript -e "install.packages(c('future', 'templr', 'base64enc'), repos='https://cloud.r-project.org')"
    
    - name: Run basic structure test
      run: |
        Rscript tests/test_basic.R
    
    - name: Run example (if available)
      continue-on-error: true
      run: |
        if [ -f examples/branin_example.R ]; then
          timeout 120 Rscript examples/branin_example.R || echo "Example test timed out or failed"
        fi
